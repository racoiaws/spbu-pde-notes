% !TEX encoding = UTF-8 Unicode
% лекция 1, 13 февраля 2016
% Однородное линейное транспортное уравнение с постоянными коэффициентами, его физический смысл (задача о распространении пятна загрязнения в канале). Решение однородного уравнения методом характеристик. Бегущая волна.
% Неоднородное линейное транспортное уравнение ... (начало)
\chapter*{Введение}
\section*{Обозначения и некоторые определения}
\begin{enumerate}
\item $\real^n$ - евклидово пространство.
\item $\abs{x}$ - евклидова норма $x$ из $\real^n$.
\item Область - открытое множество в $\real^n$.
\item Если где-то написано $\bar{\Omega}$, то $\Omega$ - ограниченная область.
\item $C(\bar{\Omega})$ - пространство непрерывных функций на $\bar{\Omega}$ с $\infty$-нормой: $\sup \{ \abs{f(x)} : x \in \bar{\Omega} \}$.
\item $L^p (\Omega)$ - пространство с нормой Гёльдера, $1 \leq p \leq \infty$.
\item $L^\infty (\Omega)$ - пространство существенно ограниченных функций.
\item $C^k(\bar{\Omega})$ - все частные производные до порядка $k$ включительно существуют и непрерывны вплоть до границы.
\item $C(\Omega)$ - функции, непрерывные на $\Omega$, не вплоть до границы. Не является нормированным пространством.
\item Носитель функции - замыкание множества, на котором функция не равна $0$. Носитель функции $f$ обозначается $\supp f$.
\item Финитная функция - функция с компактным носителем.
\item $C^k_0(\Omega)$ - финитные $k$ раз гладкие функции.
\item $K \ssubset \Omega$ - K относительно компактно в $\Omega$.
\item $\displaystyle \fint \limits_{\Omega} f(x) dx = \frac{1}{|\Omega|} \int \limits_{\Omega} f(x) dx$, где $\abs{\Omega}$ - мера Лебега области $\Omega$.
% добавить про линейное уравнение (через дифференциальный оператор)
\end{enumerate}

Весь курс будет построен следующим образом, он делится на две части. Одна большая, классическая, скорее относящаяся к веку 19ому. Я вам покажу несколько конкретных физических моделей, для них с той или иной степенью подробности выведу уравнение, и дальше для какой-то очень конкретной ситуации скажу, как его решать. Как правило, можно будет написать явную формулу. Практически вся первая часть будет про уравнения вообще. Не буду вам весь "зоопарк" рассказывать, только наиболее популярные уравнения и очень частные случаи, в которых можно написать явную формулу и что-то про неё сказать, как это с физикой связано.
Вторая часть будет меньше, она более современная, не скажу, что она совсем современная. Она, наверное, будет концепнуально новой, такого у вас в других курсах не было, понадобится функциональный анализ. По крайней мере для одной задачи расскажу, как получать общее решение, доказывать существование решения, численное решение строить, которое гарантированно сойдётся.
А сейчас так: конкретная физическая модель и какие-то частные случаи.

Все что угодно делайте, только не учите это наизусть, пожалуйста.
- Это карается?
Мне, конечно, всё равно. Но в 100\% случаев когда люди учат наизусть и нараспев, всё правильно написано, ткнёшь в формулу - что она означает? Всё, люди теряются. Если вы что-то забыли, я всегда разрешу подсмотреть в конспект и  возобновить какие-то знания. Мне важно, чтобы вы понимали, что здесь происходит, и могли что-то самостоятельно вывести. Знание чего-то наизусть ни в коем случае от вас не требуется. Ну и не только в этом курсе, а вообще в каких-то математических курсах. Наиболее вредное из того, что вы можете себе устроить из вашего обучения математике, это попытка заучить что-то наизусть.

Есть разница между обучением между в медицинском институте и на матмехе - в медицинском институте надо развивать память. А на матмехе не надо.


\chapter{}
\section{Задача о распространении пятна загрязнения в канале}
Рассмотрим ситуацию: имеется водоём. В него было сброшено некоторое количество загрязняющего вещества.
Для простоты в качестве водоёма будем рассматривать реку или канал. Пренебрегаем тем, что происходит между берегами. Нас интересует, как загрязнение распространяется в длину, поэтому реку считаем одномерным объектом.

Обозначим через $c (t, x) $ концентрацию загрязняющего вещества в момент $t \in \real_+$ в точке $x \in \real$. Пусть дана функция $ c_0 (x) $, описывающая концентрацию вещества в начальный момент времени $ t = 0 $:
$$ c_0 (x) = c (0, x).$$
% функция линейна
Задача состоит в том, чтобы описать изменение концентрации загрязняющего вещества в реке при условии, что мы что-то знаем про течение реки. Как минимум мы знаем скорость. Будем считать, что загрязняющее вещество никуда не испаряется, тогда можно воспользоваться законом сохранения массы.

\subsection{Закон сохранения массы}

Рассмотрим изменение концентрации вещества на некотором малом интервале $ [x, x + \Delta x] $:
$$ \dsint \limits_x^{x + \Delta x} c (t, \xi) d \xi .$$
Рассмотрим функцию $ q (t, x) $ - поток загрязняющего вещества в момент времени $t$ через стенку $x$. Изменение концентрации можно описать как разность величин "сколько влилось" и "сколько вылилось": 
$$ \dsint \limits_x^{x + \Delta x} c (t, \xi) d \xi = q (t, x) - q (t, x + \Delta x). $$
Будем считать, что функция $q (t, x) $ достаточно гладкая. Внесём под интеграл $ \displaystyle \frac {d} {dt} $, а потом разделим обе части на длину нашего малого интервала $ \Delta x$:
$$ \fint \limits_x^{x + \Delta x} c_t (t, \xi) d \xi  = \frac {q  (t, x) - q (t, x + \Delta x)} {\Delta x}.$$
Далее, устремим длину интервала $\Delta x$ к нулю. Получим, собственно, закон сохранения массы:
$$ c_t (t, x) = -q_x (t, x). $$

Стоит заметить, что предположения о гладкости и других нужных свойствах используемых функций это распространённый приём, используемый физиками для построения моделей. Эти условия достаточно сильны, и не всегда физическое явление можно описать достаточно хорошей функцией. В дальнейшем мы узнаем, что существуют более общие математические модели, которые лучше подходят для описания физических процессов.


Далее хочется узнать, как этот поток зависит от концентрации.

\subsection{Модели}
\subsubsection*{Чистая конвекция или чистый дрейф (транспортное уравнение)}

Допустим, скорость течения $v$ постоянна, а загрязняющее вещество мало диффундирует. То есть, загрязняющее вещество не смешивается с водой (в качестве примера можно привести сброс нефти в реку). Тогда поток вещества, проходящего через точку $x$ равен концентрации вещества умножить на скорость:
$$ q (t, x) = v c (t, x). $$
Если подставить вместо потока закон сохранения массы, то получим транспортное уравнение:
$$ c_t + v c_x = 0.$$

Полностью это уравнение называется однородным линейным транспортным уравнением с постоянными коэффициентами в одномерном случае.

\subsubsection*{Уравнение диффузии (закон Фика) или теплопроводности (закон Фурье)}

Допустим, течения нет (то есть, $ v \equiv 0 $), а загрязняющее вещество хорошо диффундирует (в качестве примера можно привести сброс стирального порошка в стоячий канал). Тогда
$$ q (t, x) = - D c_x (t, x), $$
где $D$ это некоторый коэффициент диффузии.

Это уравнение означает, что в момент времени $t$ поток через стенку $x$ пропорционален градиенту концентрации. Минус в правой части означает, что поток идёт оттуда, где концентрация больше, туда, где она меньше.

Позже мы узнаем, что эта же модель является моделью распространения тепла. В ней величина $1/D$ называется коэффициентом температуропроводности.

\subsubsection*{Уравнение конвекции-диффузии или конвекции с дрейфом (закон Фоккера-Планка)}
% на лекции больше ничего не было
% кроме того, что оно используется в computer science при моделировании (?) стохастических процессов
% но, опять же, это теорвер 
Эта модель описывает случай, когда присутствует и конвекция, и диффузия:
$$ q (t, x)  = x c - D c_x. $$
Подставив закон сохранения массы, получим:
$$ c_t + v_{cx} = D c_{xx}. $$

Помимо физики, такое уравнение часто встречается в теории вероятностей.

\subsection{Решение однородного транспортного уравнения}
Что мы имеем ввиду, когда говорим "решение"? Мы имеем ввиду классическое решение - функцию, которая при подстановке в уравнение даст верное соотношение. Для этого она должна обладать нужной гладкостью, а условия уравнения должны соблюдаться в каждой точке. Так понимали решения до тридцатых годов XX века. К сожалению, оказалось, что для дифференциальных уравнений в частных производных классическое решение - не самое лучшее, и зачастую его недостаточно.

За последний век было придумано много разных решений, обобщающих понятие классического: слабые, вязкостные, энтропийные. Немного позже мы узнаем об одном из них - слабом. Но пока что мы остановимся на уровне XIX века и будем рассматривать только классические решения.

Итак, нам нужно найти некоторую функцию, которая не только удовлетворяет транспортному уравнению, но еще и удовлетворяет начальному условию $ c (0, x) = c_0 (x) $:

\begin{align}
    \begin{cases} 
        c_t + v c_x = 0, \\
        c (0, x) = c_0 (x).
    \end{cases}
\label{transport}
\end{align}

Когда мы выводили это уравнение, мы брали небольшой промежуток реки от $x$ до $ x + \Delta x $ и смотрели, как распространяется загрязняющее вещество в нём. Теперь поступим по-другому: посмотрим, как ведёт себя каждая частица вещества в реке. Каждая частица плывёт по направлению течения со скоростью $v$. Значит, траектория каждой частицы удовлетворяет вспомогательному дифференциальному уравнению $ \dot x = v $. Каково решение этого уравнения?

\[
	x(0) = x_0,\quad \text{тогда } x(t) = x_0 + v t .
\]


Пусть $ c (t, x) $ - решение нашего транспортного уравнения. Подставим $ x(t) $ вместо $x$. То есть, каждая частица вещества двигается по закону $ \dot x = v $. Что получится, если мы посмотрим концентрацию вещества вдоль траектории этого ОДУ?

\begin{align*}
    \frac {d} {dt} c (t, x(t)) & = c_t (t, x(t)) + c_x (x, t) \cdot \dot x (t) = c_t (t, x(t)) + v c_x (t, x(t)) = 0
\end{align*}
%?????
Получается, что $ c_t (t, x(t)) = 0 $. Иначе говоря, вдоль траектории вспомогательного ОДУ функция $c$ является постоянной.




Как теперь найти $ c (t,x) $? Есть точка $ (t, x) $, требуется найти значение концентрации в ней. Смотрим, какая траектория ОДУ проходит через эту точку: через неё проходит единственная прямая. Знаем, что вдоль этой траектории $ c = const $, значит, $ c (t, x) = c_0 (x_0) $. А как выражается $ x_0 $? $ x = x_0 + v t $, значит, $ x_0 = x - vt $.
Итого $c(t,x) = c_0(x(0)) = c_0(x-vt)$.

\begin{definition} Обыкновенное дифференциальное уравнение, вдоль траекторий которого решения уравнения в частных производных постоянны, называется характеристическим.
\end{definition}

\begin{definition} Траектории характеристического уравнения называются характеристическими линиями или характеристиками.
\end{definition}

Наша задача оказалась устроена так, что через каждую точку проходит единственная характеристическая линия. Отсюда, зная начальное значение, мы нашли формулу для решения задачи Коши для транспортного уравнения.

Оформим результат рассуждений в виде теоремы.

\begin{theorem}
Пусть $c_0 \in C^1(t)$. Тогда задача \eqref{transport} имеет единственное классическое решение $$ c (t,x) = c_0 (x - v t) .$$
\end{theorem}


\pagebreak

Давайте будем считать, что $ c(t, x) $ (??) - наше решение. Рассмотрим вспомогательное уравнение $$ \frac {dx} {dt} = v $$. Тут всё, что я буду делать, можно разделить на две части:
\begin{enumerate}
\item можно проделать какие-то формальные действия и получить решение
\item вы можете спросить, откуда я догадался?
\end{enumerate}

Когда я выводил это уравнение, я смотрел, как распространяется это пятно целиком. То есть, я брал отдельный элемент массы воды от $x$ до $ x + \Delta x $ и смотрел, как сохраняется масса загрязняющего вещества в этом элементе. То есть, как распространяется каждый отдельный большой элемент загрязняющего вещества. Вместо этого я мог бы посмотреть на другое: я мог бы посмотреть, как ведёт себя каждая частица этой жидкости, плывущей в реке. Как она плывёт? Она плывёт направо (по рисунку) со скоростью $v$. Траектория каждой частицы должна удовлетворять вот такому дифференциальному уравнению: $ \displaystyle \frac {dx} {dt} = v $. Концентрация загрязняющего вещества должна распространяться таким образом, чтобы каждая частица бежала по траектории этого дифференциального уравнения.
Решение какое?
$$ x(0) = x_0,\quad \text{тогда }x(t) = x_0 + v t $$

$c (t, x)$ - наша функция. Давайте вместо $x$ подставим $ x(t) $. То есть, каждая частичка должна сдвигаться по закону $\dot x = v$. Давайте продифференцируем.

Смотрим концентрацию вдоль траектории этого ОДУ. Что получается?

\begin{align*}
    \frac {d} {dt} c (t, x(t)) & = c_t (t, x(t)) + c_x (x, t) \cdot \dot x (t) = = c_t (t, x(t)) + v c_x (t, x(t)) = 0
\end{align*}

Мы получили, что $ c_t (t,x(t)) = 0 $. Иначе говоря, вдоль траектории ОДУ функция c является постоянной.
Значит
$$ c(t,x(t)) = const,\quad \text{для любого } x \text{, удовлетворяющего ОДУ}$$

$$с(t,x(t)) = c_0(x(0)) + $$
%?????какой-то вывод

Как теперь найти $c(t,x)$? Графически легко это увидеть.
Есть точка $(t,x)$, хотим найти значение концентрации. Я смотрю, какая траектория ОДУ проходит через эту точку, через неё проходит единственная такая прямая. Я знаю, что вдоль этой траектории c = const, значит, её значение = $c_0(x_0)$
Как x_0 выражается? $x = x_0 + vt$, значит,$ x_0 = x - vt$.
Получается $c(t,x) = c_0(x(0)) = c_0(x-vt)$. Получили решение.

Здесь есть, что обсудить. Что мы сделали? Я нашёл некоторое ОДУ. Такое ОДУ называется характеристическим для ДУвЧП. Его свойство такое: вдоль траектории этого ОДУ решения ДУвЧП постоянны. Соответственно, его траектории называются характеристическими линиями или (на жаргоне) характеристиками.

Задача оказалась устроена так, что через каждую $(x,t)$ проходит только одна характеристическая линия. А на характеристических линиях искомая функция должна быть постоянной. Отсюда, зная начальное значение, находим формулу для решения ДУвЧП.

Напишем ответ. Поскольку мы математики, должны написать ответ чисто.

\begin{note} (Теорема) Пусть $c_0 in ...$, тогда задача 1 имеет единственное классическое решение, выражающееся $c(t,x) = c_0(x - vt)$.
\end{note}
Заполним многоточие. Какому классу должно принадлежать наше решение, чтобы оно было классическим? 

\begin{theorem}
Теорема. Пусть $c_0 \in C^1(t)$, тогда задача 1 имеет единственное классическое решение, выражающееся $c(t,x) = c_0(x - vt)$
\end{theorem}

Здесь есть, что обсудить. Скажите, как выглядит этот профиль? [рисует на доске]

Концентрация была какой-то такой. Что будет при $t$ большем? Когда t будет увеличиваться, то этот самый профиль будет смещаться просто на $vt$ вправо. Решение - "бегущая волна". Начальное возмущение, не меняя формы, распространяется со скоростью v направо.

Теперь вопрос: почему единственность имеет место? Где здесь было доказательство единственности? Я же полностью проговорил. Пусть $c(t,x)$ - решение, тогда $c(t,x(t)) = const$, тогда $c(t,x(t)) = c_0(x(0))$, тогда, выражая $x_0$ через $x$ и $t_0$ получаем решение. Получили четкую цепочку следствий: если c - решение, то c должно иметь такую форму. Никаких других решений нет, в доказательстве было в том числе и доказательство единственности.

Второй момент. Я же вам сказал, как распространяется это возмущение. Распространяется волна такая. Но, видите, для того, чтобы считать это решение классическим, нам потребовалось, чтобы C была 1 раз непрерывно дифференцируемой, что, вообще говоря, довольно странно. Вы можете себе представлять такую идеализированную модель. Сбросили загрязнение не такой профиль, а ровно вот так [показывает на доске]. Вот от этой точки до этой точки загрязнено, а чуть право и чуть влево - нет. Не $C^1$. Можно думать о такой физической задаче? Вполне можно. Теперь так. Эта формула осмыслена? Осмыслена. Если пятно изначально было таким, то оно и будет дальше идти так, не меняя формы. Но формально назвать это классическим решением это нельзя: если начальный профиль не $C^1$, то то, что здесь написано, производных иметь не будет и, формально, определению решения не удовлетворяет. Это намекает на то, что для физиков понятие классического решения может оказаться неадекватным ситуации. Вроде модель реальна, и формула даёт что-то разумное физически, но с формальной точки зрения она не имеет отношения к уравнению, производные здесь нельзя написать. Но, тем не менее, с какой-то другой точки зрения имеет отношение, потому что если мы исходные интегральные соотношения напишем, то, наверное, будет иметь смысл. Это намёк на то, что, по-хорошему, нужно уходить от понятия классического решения и как-то ослаблять требования. То есть, нужно будет понимать под решением не только то, что является классическим решением, а еще и что-то другое.

Теперь про характеристики. Я каким-то образом догадался написать характеристическое уравнение. Кто-то мне мог подсказать: посмотри, как себя ведет решение уравения. Я даже могу сказать, откуда догадался: из чисто физических соображений, как каждая частичка себя ведёт. Если бы не догадался, то не смог бы решить. Но если кто-нибудь бы дал мне формулу, то я бы мог проверить. Можно не знать всего этого дела, кто-то скажет: формула такая, она является решением, или нет? Написана теорема, тебе нужно её доказать! Единственность просто так не докажете, а то, что это решение - докажете. Подставляете - получается. А чтобы единственность доказать, нужно проделать все эти операции.


\subsection{Неоднородное транспортное уравнение и его решение}

Тоже распространения пятна загрязнения, с доп особенностью: не просто кто-то выбросил загрязняющее вещество, а есть какой-то источник или, возможно, сток, с какой-то заданной мощностью. Хочется такую модель рассмотреть.

Тогда $d/dt \int \limits_x^{x + \Delta x} c(t, \xi ) d \xi$ - насколько в момент t меняется концентрация загрязняющего вещества на интервале от $x + \delta x = q(t, x) - q(t, x + \delta x) + \int \limits_x^{x+\delta x} f(t,\xi) d\xi$, где $f$ - плотность источников звгрязнения на единицу длины в момент времени t.
Опять $d/dt$ проносим внутрь считая, что всё регулярно и проносить имеем право, делим на $dx$, устремляем $dx$ к нулю, получится:
$$c_t(t,x) = -d'(t,x) + f(t, x)$$
Далее подставляем выражение для q и получаем дифф уравнение
Для случая чистой конвекции что получается:
$$q = vc$$
%$$
уравнение 2 - лин ДУвЧП 1 порядка, неоднородное.

Давайте решать. Посмотрим, как будет вести себя классическое решения на траекториях $dx/dt = v$
В случае однородного нам это помогло. Возможно, поможет и в случае неоднородного тоже.
Пусть $c(t,x)$ - классическое решение (2), .$x(t) = v => x = x0 + vt$
Давайте рассмотрим, как ведет себя это решение на траекториях моего характеристического уравнения. $d/dt C(t, x(t)) = ... = f (t, x(t))$. Так, иначе говоря, давайте x(t) явным образом подставим сюда: $d/dt C(t, x_0 + vt) = f(t, x_0 + vt) \forall t, x_0$, а это уже обыкновенное дифференциальное уравнение, можем явным образом выписать его решение (а еще известно, что $C(0, x_0) = C_0(x_0)$). Выпишем решение: [вывод]. Получили $C(t, x) = ... (2')$ - вот вам решение. Но мыжматематики, должны написать, когда это действительно решение. Давайте сформулируем теорему.

\begin{theorem}
Пусть $C_0 \in C^1(\real), f \in C(\real^+ \times \real), f_x \in C(\real^+ \times \real)$. Тогда задача (2) имеет единственное классическое решение, задаваемое формулой (2'). [чтобы получить условия на f и f_x что-то куда-то подставляем, дифференцируем вот это вот по вот этому, а потом дифференцируем вот то]
\end{theorem}

Опять-таки, намек на то, что классическое решение - понятие очень уж тяжелое для физиков. Получается, чтобы решение было классическим [что-то], f должна иметь какую-то дополнительную гладкость по пространственной переменной. Откуда такое - это совершенно не физичное условие. f - это удельная по длине мощность источников или стоков загрязняющего вещества. Ладно еще непрерывная, черт с ним, но почему она должна быть еще и гладкой по пространственной переменной - совершенно непонятно. Очень даже можно представить себе непрерывную негладкую функцию. Пока работаем с классическими решениями, вынуждены требовать такие странные условия [дальше диалог про то, как выглядит слив в точке, что-то рисует на доске; можно решать уравнения, в которых вместо функции - мера]