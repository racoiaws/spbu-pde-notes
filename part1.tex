% !TEX encoding = UTF-8 Unicode
% лекция 1, 13 февраля 2016
% Однородное линейное транспортное уравнение с постоянными коэффициентами, его физический смысл (задача о распространении пятна загрязнения в канале). Решение однородного уравнения методом характеристик. Бегущая волна.
% Неоднородное линейное транспортное уравнение
\chapter*{Введение}
Курс рассчитан на один семестр и делится на две части.

Первая - классическая, она относится скорее к 19ому веку. Будет рассмотрено несколько конкретных физических моделей, соответствующие уравнения в частных производных будут выведены и решены для некоторых частных случаев.

Вторая часть более современная, и, скорее всего, она окажется концепутально новой. По крайней мере для одной задачи будет получено общее решение, будет доказано существование решения и предложено сходящееся численное решение.

\pagebreak

\section*{Обозначения и некоторые определения}
\begin{enumerate}
\item $\real^n$ - евклидово пространство.
\item $\abs{x}$ - евклидова норма $x$ из $\real^n$.
\item Область - открытое множество в $\real^n$.
\item Если где-то написано $\bar{\Omega}$, то $\Omega$ - ограниченная область.
\item $C(\bar{\Omega})$ - пространство непрерывных функций на $\bar{\Omega}$ с $\infty$-нормой: $\sup \{ \abs{f(x)} : x \in \bar{\Omega} \}$.
\item $L^p (\Omega)$ - пространство с нормой Гёльдера, $1 \leq p \leq \infty$.
\item $L^\infty (\Omega)$ - пространство существенно ограниченных функций.
\item $C^k(\bar{\Omega})$ - все частные производные до порядка $k$ включительно существуют и непрерывны вплоть до границы.
\item $C(\Omega)$ - функции, непрерывные на $\Omega$, не вплоть до границы. Не является нормированным пространством.
\item Носитель функции - замыкание множества, на котором функция не равна $0$. Носитель функции $f$ обозначается $\supp f$.
\item Финитная функция - функция с компактным носителем.
\item $C^k_0(\Omega)$ - финитные $k$ раз гладкие функции.
\item $K \ssubset \Omega$ - K относительно компактно в $\Omega$.
\item $\displaystyle \fint \limits_{\Omega} f(x) dx = \frac{1}{|\Omega|} \int \limits_{\Omega} f(x) dx$, где $\abs{\Omega}$ - мера Лебега области $\Omega$.
% добавить про линейное уравнение (через дифференциальный оператор)
\end{enumerate}

\chapter{}
\section{Задача о распространении пятна загрязнения в канале}
Рассмотрим ситуацию: имеется водоём. В него было сброшено некоторое количество загрязняющего вещества.
Для простоты в качестве водоёма будем рассматривать реку или канал. Пренебрегаем тем, что происходит между берегами. Нас интересует, как загрязнение распространяется в длину, поэтому реку считаем одномерным объектом.

Обозначим через $c (t, x) $ концентрацию загрязняющего вещества в момент $t \in \real_+$ в точке $x \in \real$. Пусть дана функция $ c_0 (x) $, описывающая концентрацию вещества в начальный момент времени $ t = 0 $:
$$ c_0 (x) = c (0, x).$$
% функция линейна
Задача состоит в том, чтобы описать изменение концентрации загрязняющего вещества в реке при условии, что мы что-то знаем про течение реки. Как минимум мы знаем скорость. Будем считать, что загрязняющее вещество никуда не испаряется, тогда можно воспользоваться законом сохранения массы.

\subsection{Закон сохранения массы}

Рассмотрим изменение концентрации вещества на некотором малом интервале $ [x, x + \Delta x] $:
$$ \dsint \limits_x^{x + \Delta x} c (t, \xi) d \xi .$$
Рассмотрим функцию $ q (t, x) $ - поток загрязняющего вещества в момент времени $t$ через стенку $x$. Изменение концентрации можно описать как разность величин "сколько влилось" и "сколько вылилось": 
$$ \dsint \limits_x^{x + \Delta x} c (t, \xi) d \xi = q (t, x) - q (t, x + \Delta x). $$
Будем считать, что функция $q (t, x) $ достаточно гладкая. Внесём под интеграл $ \displaystyle \frac {d} {dt} $, а потом разделим обе части на длину нашего малого интервала $ \Delta x$:
$$ \fint \limits_x^{x + \Delta x} c_t (t, \xi) d \xi  = \frac {q  (t, x) - q (t, x + \Delta x)} {\Delta x}.$$
Далее, устремим длину интервала $\Delta x$ к нулю. Получим, собственно, закон сохранения массы:
$$ c_t (t, x) = -q_x (t, x). $$

Стоит заметить, что предположения о гладкости и других нужных свойствах используемых функций это распространённый приём, используемый физиками для построения моделей. Эти условия достаточно сильны, и не всегда физическое явление можно описать достаточно хорошей функцией. В дальнейшем мы узнаем, что существуют более общие математические модели, которые лучше подходят для описания физических процессов.


Далее хочется узнать, как этот поток зависит от концентрации.

\subsection{Модели}
\subsubsection*{Чистая конвекция или чистый дрейф (транспортное уравнение)}

Допустим, скорость течения $v$ постоянна, а загрязняющее вещество мало диффундирует. То есть, загрязняющее вещество не смешивается с водой (в качестве примера можно привести сброс нефти в реку). Тогда поток вещества, проходящего через точку $x$ равен концентрации вещества умножить на скорость:
$$ q (t, x) = v c (t, x). $$
Если подставить вместо потока закон сохранения массы, то получим транспортное уравнение:
$$ c_t + v c_x = 0.$$

Полностью это уравнение называется однородным линейным транспортным уравнением с постоянными коэффициентами в одномерном случае.

\subsubsection*{Уравнение диффузии (закон Фика) или теплопроводности (закон Фурье)}

Допустим, течения нет (то есть, $ v \equiv 0 $), а загрязняющее вещество хорошо диффундирует (в качестве примера можно привести сброс стирального порошка в стоячий канал). Тогда
$$ q (t, x) = - D c_x (t, x), $$
где $D$ это некоторый коэффициент диффузии.

Это уравнение означает, что в момент времени $t$ поток через стенку $x$ пропорционален градиенту концентрации. Минус в правой части означает, что поток идёт оттуда, где концентрация больше, туда, где она меньше.

Позже мы узнаем, что эта же модель является моделью распространения тепла. В ней величина $1/D$ называется коэффициентом температуропроводности.

\subsubsection*{Уравнение конвекции-диффузии или конвекции с дрейфом (закон Фоккера-Планка)}
% на лекции больше ничего не было
% кроме того, что оно используется в computer science при моделировании (?) стохастических процессов
% но, опять же, это теорвер 
Эта модель описывает случай, когда присутствует и конвекция, и диффузия:
$$ q (t, x)  = x c - D c_x. $$
Подставив закон сохранения массы, получим:
$$ c_t + v_{cx} = D c_{xx}. $$

Помимо физики, такое уравнение часто встречается в теории вероятностей.

\subsection{Решение однородного транспортного уравнения}
Что мы имеем ввиду, когда говорим "решение"? Мы имеем ввиду классическое решение - функцию, которая при подстановке в уравнение даст верное соотношение. Для этого она должна обладать нужной гладкостью, а условия уравнения должны соблюдаться в каждой точке. Так понимали решения до тридцатых годов XX века. К сожалению, оказалось, что для дифференциальных уравнений в частных производных классическое решение - не самое лучшее, и зачастую его недостаточно.

За последний век было придумано много разных решений, обобщающих понятие классического: слабые, вязкостные, энтропийные. Немного позже мы узнаем об одном из них - слабом. Но пока что мы остановимся на уровне XIX века и будем рассматривать только классические решения.

Итак, нам нужно найти некоторую функцию, которая не только удовлетворяет транспортному уравнению, но еще и удовлетворяет начальному условию $ c (0, x) = c_0 (x) $:

\begin{align}
    \begin{cases} 
        c_t + v c_x = 0, \\
        c (0, x) = c_0 (x).
    \end{cases}
\label{transport}
\end{align}

Когда мы выводили это уравнение, мы брали небольшой промежуток реки от $x$ до $ x + \Delta x $ и смотрели, как распространяется загрязняющее вещество в нём. Теперь поступим по-другому: посмотрим, как ведёт себя каждая частица вещества в реке. Каждая частица плывёт по направлению течения со скоростью $v$. Значит, траектория каждой частицы удовлетворяет вспомогательному дифференциальному уравнению $ \dot x = v $. Каково решение этого уравнения?

\[
	x(0) = x_0,\quad \text{тогда } x(t) = x_0 + v t .
\]


Пусть $ c (t, x) $ - решение нашего транспортного уравнения. Подставим $ x(t) $ вместо $x$. То есть, каждая частица вещества двигается по закону $ \dot x = v $. Что получится, если мы посмотрим концентрацию вещества вдоль траектории этого ОДУ?

\begin{align*}
    \frac {d} {dt} c (t, x(t)) & = c_t (t, x(t)) + c_x (x, t) \cdot \dot x (t) = c_t (t, x(t)) + v c_x (t, x(t)) = 0
\end{align*}
%?????
Получается, что $ c_t (t, x(t)) = 0 $. Иначе говоря, вдоль траектории вспомогательного ОДУ функция $c$ является постоянной.




Как теперь найти $ c (t,x) $? Есть точка $ (t, x) $, требуется найти значение концентрации в ней. Смотрим, какая траектория ОДУ проходит через эту точку: через неё проходит единственная прямая. Знаем, что вдоль этой траектории $ c = const $, значит, $ c (t, x) = c_0 (x_0) $. А как выражается $ x_0 $? $ x = x_0 + v t $, значит, $ x_0 = x - vt $.
Итого $c(t,x) = c_0(x(0)) = c_0(x-vt)$.

\begin{definition} Обыкновенное дифференциальное уравнение, вдоль траекторий которого решения уравнения в частных производных постоянны, называется характеристическим.
\end{definition}

\begin{definition} Траектории характеристического уравнения называются характеристическими линиями или характеристиками.
\end{definition}

Наша задача оказалась устроена так, что через каждую точку проходит единственная характеристическая линия. Отсюда, зная начальное значение, мы нашли формулу для решения задачи Коши для транспортного уравнения.

Оформим результат рассуждений в виде теоремы.

\begin{theorem}
Пусть $c_0 \in C^1(t)$. Тогда задача \eqref{transport} имеет единственное классическое решение $$ c (t,x) = c_0 (x - v t) .$$
\end{theorem}

\input{illustrations/lect1.1.tex}

Как выглядит наше решение? Это видно на графиках. При увеличении $t$ профиль нашего загрязнения будет просто смещаться по течению на $vt$. То есть, начальное возмущение, не меняя формы, распространяется со скоростью $v$ - получили бегущую волну.

Тем не менее, для того, чтобы функция считалась классическим решением, она должна принадлежать $C^1$, что, вообще говоря, довольно странно, ведь в реальной задаче функция, описывающая контур профиля загрязнения, вполне может быть не из $C^1$ (например, если профиль - прямоугольник). Получается, что понятие классического решения может оказаться неподходящим и надо каким-то образом ослаблять требования.

\subsection{Неоднородное транспортное уравнение и его решение}

Немного изменим модель. Допустим, сброс был не единовременным, и имеется некий источник загрязняющего вещества с заданной мощностью $f(t,x)$. % мощностью?

Снова рассмотрим изменение концентрации вещества на некотором малом интервале:
$$ \dsint \limits_x^{x + \Delta x} c (t, \xi) d \xi .$$
И снова $ q (t, x) $ - поток загрязняющего вещества в момент времени $t$ через стенку $x$. Тогда, учитывая источник вещества $f$:
$$ \frac{d}{dt} \int \limits_x^{x + \Delta x} c(t, \xi ) d \xi = q(t, x) - q(t, x + \Delta x) + \int \limits_x^{x+\Delta x} f(t,\xi) d\xi. $$
Предполагая достаточную гладкость, вносим $ \displaystyle \frac {d} {dt} $ под интеграл и делим на $ \Delta x $:
$$ \fint \limits_x^{x + \Delta x} c_t (t, \xi) d \xi  = \frac {q  (t, x) - q (t, x + \Delta x)}  {\Delta x} + \fint \limits_x^{x+\Delta x} f(t,\xi) d\xi. $$
Устремляя $ \Delta x$ к нулю, в случае чистой конвекции ($ q = vc $) получаем линейное неоднородное транспортное уравнение:

$$ c_t (t, x) = - vc_x (t, x) + f(t, x). $$

Поставим задачу Коши:

\begin{align}
    \begin{cases} 
        c_t + v c_x = f, \\
        c (0, x) = c_0 (x).
    \end{cases}
\label{transportnonhom}
\end{align}

Посмотрим, как будет вести себя классическое решение на траекториях $ \dot x = v $.
\[
	x(0) = x_0,\quad \text{тогда } x(t) = x_0 + v t .
\]
Подставим $x(t)$ в наше неоднородное уравнение:
$$ c (t, x_0 + vt) = c_0 (x_0) + \int \limits_0^t f(s, x_0 + vs) ds. $$
Заметим, что $ x_0 = x - vt $, тогда
$$ c (t, x) = c_0 (x - vt) + \int \limits_0^t f(s, x + v(s-t)) ds. $$

Оформим результат  в виде теоремы.

\begin{theorem}
Пусть $c_0 \in C^1(\real)$, $f \in C (\real^+ \times \real)$, $f_x \in C (\real^+ \times \real)$. Тогда задача \eqref{transportnonhom} имеет единственное классическое решение $$ c (t, x) = c_0 (x - vt) + \int \limits_0^t f(s, x + v(s-t)) ds .$$
\end{theorem}

Вообще говоря, гладкость $f$ по пространственной переменной - совершенно нефизичное условие, в отличие от непрерывности. Позже мы узнаем про слабые решения, где вместо функций могут фигурировать, например, меры.

В данном случае у нас была чистая конвекция и скорость ни от чего не зависела. Но что получится, если скорость зависит от $x$ и от $t$? Тогда ОДУ будет таким же, но его траектории не обязательно будут прямыми. Существенным условие тут является единственность решения характеристического уравнения. Она нарушается, если $v$ зависит от $x$ не гладким образом, а, скажем, просто непрерывным. Тогда может оказаться, что через одну точку проходит несколько характеристических линий (классический пример - квадратный корень).

А что произойдёт, если у нас не конвекция, а чистая диффузия? Можно ли придумать для $c_t = -Dc_{xx}$ характеристическое уравнение, вдоль траекторий которого решение будет константой? Вообще говоря, можно, но это будет не обыкновенное уравнение, а стохастическое. Для таких уравнений мы не можем найти детерминированные траектории, вдоль которых концентрация не меняется. Но можно "рвзыгрывать" траектории с определенной вероятностью по некоторому закону так, что в среднем для мноих траекторий концентрация постоянна. Таким образом, уравнение диффузии связано со стохастикой.