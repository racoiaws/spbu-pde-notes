% !TEX encoding = UTF-8 Unicode
% лекция 2, 20 февраля 2016
% Неоднородное линейное транспортное уравнение с постоянными коэффициентами, его физический смысл (задача о распространении пятна загрязнения в канале). Решение неоднородного уравнения методом характеристик. (продолжение)
% Основная лемма вариационного исчисления для непрерывных функций.
% Основная лемма вариационного исчисления для локально интегрируемых функций.

\section{Основная лемма вариационного исчисления}
\subsection{Слабая версия}
\begin{lemma}{(Дюбуа-Реймон).}
Пусть область $\Omega \subset \real^n$, функция $u \in C(\Omega)$ такая, что 
$$\dsint \limits_{\Omega} u \varphi dx = 0$$ 
для любой $\varphi \in C_0^\infty(\Omega)$. Тогда $u \equiv 0$ всюду в $\Omega$.
\end{lemma}

\begin{proof}
От обратного. Предположим, что существует точка $x_0 \in \Omega$ такая, что $u(x_0) > 0$ (или меньше, неважно; считаем для определенности, что больше). 
Так как $u$ - непрерывная функция, найдется радиус $r$ такой, что шар $B_r(x_0) \subset \Omega$ и $u(x) > 0$ для всех $x \in B_r(x_0)$.

Рассмотрим функцию $\varphi$ такую, что 
$$\varphi \in C_0^\infty(\Omega),\quad \varphi(x) > 0 \ (x \in B_r(x_0)),\quad \varphi(x) = 0 \ (x \notin B_r(x_0)).$$

Тогда
$$\int \limits_{\Omega} u \varphi dx = \int \limits_{B_r(x_0)} u \varphi dx > 0,$$ 
так как $u(x) > 0$, $\varphi(x) > 0$ для $x \in B_r(x_0)$, и мера $B_r(x_0)$ положительна. Получили противоречие с условием леммы.
\end{proof}

\begin{note}
Существует ли функция $\varphi$, удовлетворяющая условиям из доказательства? 
Построим такую функцию в одномерном случае при $r = 1$. Сначала рассмотрим функцию
$$
    \psi(t) =
        \begin{cases} 
            \mathrm{e}^{-\frac{1}{1 - t^2}}, & t \in (-1, 1) \\
            0, & t \notin (-1, 1) 
        \end{cases}
$$

Очевидно, 
$$\psi(t) > 0, \ t \in (-1, 1); \quad \psi(1) = \psi(-1) = 0.$$ 

$\psi \in C_0^\infty(\real)$ (надо проверять существование производных в граничных точках $1$ и $-1$, формула Тейлора или правило Лопиталя). 
$\supp(\phi) = [-1, 1]$.

Далее, построим искомую функцию следующим образом:
$$\varphi(x) = \psi \left(\frac{\abs{x - x_0}}{r}\right).$$
\end{note}

\subsection{Сильная версия}
\begin{definition}{Локально интегрируемые функции.}
$$L_{loc}^p(\Omega) = \{u \mid u \in L^p(K),\ \forall K \ssubset \Omega\}$$
\end{definition}

\begin{example} Рассмотрим следующие функцию $u(x)$ и область $\Omega$:
$$u(x) = \frac{1}{x},\ \Omega = (0, +\infty).$$
Тогда $u(x) \notin L^1(\Omega)$, но $u(x) \in L_{loc}^1(\Omega)$. Заметим, что $L^p(\Omega) \subset L_{loc}^p(\Omega)$.
\end{example}

Надо вспомнить конструкцию сглаживания функций из матанализа. 
Возьмем в качестве сглаживающего ядра функцию $\psi(t) \in C_0^{\infty}(\real)$ такую, что 
$$\int \limits_{-\infty}^{+\infty} \psi(t) = 1, \quad \psi(t) = 0 \ (t \notin B_1(0)).$$
Теперь рассмотрим функцию $\psi_{\eps} : \real^n \rightarrow \real$, 
$\psi_{\eps}(x) = \displaystyle \frac{1}{\eps^n}\psi \left(\frac{\abs{x}}{\eps}\right)$ - аппроксимативная единица.
Можем проверить следующее:
\begin{enumerate}
\item $\dsint \limits_{\real} \psi_{\eps} dx = 1$
\item $\supp \psi_{\eps} \subset B_{\eps}(0)$
\end{enumerate}

Как вообще эти $\psi_{\eps}$ выглядят? [рисунок] При уменьшении эпсилон носитель функции сжимается в точку 0, становится шаром все меньшего радиуса, функция же при этом возрастает. 
То есть, получаем, что
$$\lim_{\eps \to 0} \psi_{\eps}(0) = +\infty \quad \text{и} \quad \lim_{\eps \to 0} \psi_{\eps}(x) = 0 \  (x \neq 0).$$
Что еще известно про эти функции? Возьмем $u \in L_{loc}^1(\Omega)$ и определим множество $\Omega_{\eps}$ следующим образом: 
$$\Omega_{\eps} = \{ x \in \Omega \mid d(x, \partial\Omega) > \eps \} \subset \Omega.$$ 
На $\Omega_{\eps}$ можно определить такие функции: 
$$u_{\eps}(x) = \int \limits_{\Omega} u(y)\psi_{\eps}(x - y) dy = (u * \psi_{\eps})(x) \quad (\text{свертка})$$
Мы можем определить такие функции только на $\Omega_{\eps}$, т.е. вынуждены отступать от границы $\Omega$, так как в определении присутствует $\psi_{\eps}(x - y)$.

Поскольку $\psi_{\eps} \in C_0^{\infty}(\real^n)$, то $u_{\eps} \in C^{\infty}(\Omega_{\eps})$. Как доказывается? 
Легко - берем и дифференцируем, $x$ находится только в $\psi_{\eps}$, значит если хотим дифференцировать по $x$,  то производная пронесется только в $\psi_{\eps}$. Итак, получили некоторые функции, которые построены по исходной функции $u$ и являются функциями $C^{\infty}$, и, кроме того, известно следующее:
$$ \lim_{\eps \to 0} u_{\eps}(x) = u(x) \quad \text{для почти всех} \ x \in \Omega$$.
Это способ сгладить функцию, почти всюду поточечно аппроксимировать её гладкими функциями. 

Если функция не $L_{loc}^1$, а непрерывная, то сходимость будет равномерной на компактах. Хорошее упражнение - докажите, что если u - непрерывная функция, то сходимость будет не просто почти всюду, а равномерной на любом компакте в $\Omega$.

\begin{lemma}{(Дюбуа-Реймон).}
Пусть область $\Omega \subset \real^n$, функция $u \in L_{loc}^1(\Omega)$ такая, что 
$$\int \limits_{\Omega} u \varphi dx = 0$$ 
для любой $\varphi \in C_0^\infty(\Omega)$. Тогда $u(x) = 0$ почти всюду в $\Omega$.
\end{lemma}

\begin{proof}
Пусть $u \in L_{loc}^1(\Omega)$. Знаем, что
$$\intO u \varphi dx = 0$$
для любой $\varphi \in C_0^{\infty}(\Omega)$.
Рассмотрим аппроксимативную единицу $\psi_{\eps}$ и свертку $u_{\eps} = u^* \psi_{\eps}$. 
Знаем, что свертки гладкие функции, определены они только на $\Omega_{\eps}$, почти всюду сходятся к $u(x)$ при $\eps \rightarrow 0$. 
Возьмем интеграл 
$$\intO u_{\eps} \varphi dx$$
Имеет ли интеграл смысл? Ведь $u_{\eps}$ определена не на всей $\Omega$, а на $\Omega_{\eps}$. Да, имеет, так как $\varphi$ - финитные, в некоторой окрестности границы $\varphi$ всегда равна нулю. При достаточно малом $\eps$ интеграл определен. Фактически, интегрируем по $\Omega_{\eps}$, хотя и пишем $\Omega$. 
Распишем интеграл следующим образом
$$ \intO \varphi(x) dx \intO u(y) \psi_{\eps}(x - y) dy$$
Воспользуемся теоремой Фубини и поменяем порядок интегрирования
$$ \intO u(y) dy \intO \varphi(x) \psi_{\eps}(x - y) dx = \intO u(y) \varphi_{\eps}(y) dy = 0,$$
где $\varphi_{\eps}(x) = \dsint \limits_{\Omega} \varphi(x) \psi_{\eps}(x - y) dx$ - свертка $\varphi$ и $\psi_{\eps}$. 
Мы свернули две гладкие функции, одна из них финитная, поэтому $\varphi_{\eps}$ - гладкая финитная функция, а из условий теоремы следует, что интеграл от произведения $u(x)$ на любую гладкую финитную функцию равен нулю.
Получили, что 
$$\intO u_{\eps} \varphi dx = 0$$
для любой $\varphi \in C_0^{\infty}(\Omega)$.

$u_{\eps}$ - непрерывная функция, хотим применить слабый вариант леммы. Рассмотрим счетную последовательность множеств
$$\Omega_1 \subset \Omega_{\frac{1}{2}} \subset \Omega_{\frac{1}{4}} \subset ... \subset \Omega.$$
Получаем
$$u_{\eps} = 0 \ \text{на} \ \Omega_1 \ \text{при} \ \eps < 1$$
$$u_{\eps} = 0 \ \text{на} \ \Omega_{\frac{1}{2}} \ \text{при} \ \eps < \frac{1}{2}$$
$$u_{\eps} = 0 \ \text{на} \ \Omega_{\frac{1}{4}} \ \text{при} \ \eps < \frac{1}{4}$$
$$...$$
Фиксируем множество $\Omega_1$ и устремляем $\eps$ к нулю. Тогда все $u_{\eps} = 0$ и их предел равен нулю, а этот предел почти всюду совпадает с функцией $u$. Следовательно, $u = 0$ почти всюду на $\Omega_1$. Иначе говоря, есть множество $N_1 \subset \Omega$ такое, что мера Лебега этого множества равна нулю, и $u = 0$ на $\Omega_1 \setminus N_1$. 
Рассмотрим множество $\Omega_{\frac{1}{2}}$ - аналогично получаем, что $u = 0$ на $\Omega_{\frac{1}{2}} \setminus N_{\frac{1}{2}}$. Можем продолжить для любого $\Omega_{\eps}$
$$u = 0 \ \text{на} \ \Omega_1 \setminus N_1$$
$$u = 0 \ \text{на} \ \Omega_{\frac{1}{2}} \setminus N_{\frac{1}{2}}$$
$$u = 0 \ \text{на} \ \Omega_{\frac{1}{4}} \setminus N_{\frac{1}{4}}$$
$$...$$
Объединение $\Omega_{\eps}$ дает нам $\Omega$. Таким образом, получаем
$$u = 0 \ \text{на} \ \Omega \setminus \left(N_1 \cup N_{\frac{1}{2}} \cup N_{\frac{1}{4}} \cup ...\right).$$
Множеств $N_{\eps}$ счетное число, каждое из них имеет меру ноль. Счетное объединение множеств меры ноль имеет меру ноль. 
Получили, что $u = 0$ почти всюду в $\Omega$.
\end{proof}

\begin{note}
Почему интеграл из условия леммы имеет смысл? Функция может быть не интегрируема на $\Omega$, но $u\varphi$, где $\varphi$ - финитная, всегда интегрируема, если $u \in L_{loc}^1$. Почему? Потому что если $\varphi$ - финитная, это означает, что она живет на каком-то компакте, вне этого компакта она - ноль. Поэтому интеграл хоть и написан по $\Omega$, на самом деле является интегралом по носителю $\varphi$, который является компактом в $\Omega$. На нем функция интегрируема.
\end{note}

\begin{definition}{Точки Лебега.}

Пусть $u \in L_{loc}^1(\Omega)$, $\Omega \subset \real^n$ - открытое множество. 
Рассмотрим 
$$\int \limits_{B_r(x_0)} u(x) dx,$$
где $B_r(x_0) \subset \Omega$. Тогда
$$\lim_{r\to 0} \fint \limits_{B_r(x_0)} u(x) dx = u(x_0) \quad \text{для почти всех}\ x_0$$
и, более сильный факт, 
$$\lim_{r\to 0} \fint \limits_{B_r(x_0)} \abs{u(x) - u(x_0)} dx = 0 \quad \text{для почти всех}\ x_0.$$
Точки $x_0$, для которых выполняется второе соотношение, называются точками Лебега функции $u$.
\end{definition}

\begin{note}
Некоторые упражнения, которые надо уметь делать.

Из второго соотношения следует первое. Из второго соотношения следует тот факт, что $(u * \psi_{\eps})(x)$ при $\eps \rightarrow 0$ почти всюду поточечно сходится к $u(x)$.
\end{note}